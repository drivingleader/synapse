<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Quiz Hacker - CSS Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: white;
            overflow: hidden;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            height: 100dvh;
        }

        .gradient-text {
            background: linear-gradient(to right, #fbbf24, #d97706);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Animazioni */
        .card-enter { animation: slideIn 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideIn { from { transform: translateY(30px) scale(0.95); opacity: 0; } to { transform: translateY(0) scale(1); opacity: 1; } }

        .shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }

        .btn-press { transition: transform 0.05s, background-color 0.2s; }
        .btn-press:active { transform: scale(0.96); }

        /* Typography Improved */
        .dimmed-text { opacity: 0.4; font-size: 0.9rem; font-weight: 400; line-height: 1.4; }
        .highlight-text { color: #ffffff; font-weight: 900; line-height: 1.2; text-shadow: 0 0 20px rgba(251, 191, 36, 0.2); display: block; margin: 0.5rem 0; }
        
        @media (max-height: 700px) {
            .highlight-text { font-size: 1.2rem; }
            #sign-visual-container { height: 100px !important; }
            #card { padding: 1rem; }
            .start-content { transform: scale(0.9); }
        }
        @media (min-height: 701px) {
            .highlight-text { font-size: 1.5rem; }
        }

        .boss-mode { border: 2px solid #ef4444; box-shadow: 0 0 30px rgba(239, 68, 68, 0.3); }
        
        /* --- CSS SIGN GENERATOR ENGINE --- */
        .sign-canvas { position: relative; display: flex; justify-content: center; align-items: center; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3)); }
        
        /* Danger (Triangle) */
        .sign-danger {
            width: 0; height: 0;
            border-left: 60px solid transparent;
            border-right: 60px solid transparent;
            border-bottom: 104px solid #cc0000;
            position: relative;
            margin-bottom: 10px;
        }
        .sign-danger::after {
            content: ''; position: absolute;
            top: 6px; left: -45px;
            border-left: 45px solid transparent;
            border-right: 45px solid transparent;
            border-bottom: 78px solid white;
        }
        .sign-danger i {
            position: absolute; top: 45px; left: -50%; transform: translateX(-50%);
            color: #1a1a1a; font-size: 32px; z-index: 10;
        }
        
        /* Prohibition (Circle Red) */
        .sign-prohibition {
            width: 110px; height: 110px;
            background: white;
            border: 14px solid #cc0000;
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
        }
        .sign-prohibition i { color: #1a1a1a; font-size: 45px; }
        .sign-prohibition .limit-text { color: #1a1a1a; font-weight: 900; font-size: 45px; letter-spacing: -2px; }

        /* Obligation (Circle Blue) */
        .sign-obligation {
            width: 110px; height: 110px;
            background: #0055cc;
            border: 4px solid white;
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 0 0 2px #0055cc;
        }
        .sign-obligation i { color: white; font-size: 50px; }

        /* Stop (Octagon) */
        .sign-stop {
            width: 110px; height: 110px;
            background: #cc0000;
            border: 4px solid white;
            clip-path: polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%);
            display: flex; justify-content: center; align-items: center;
        }
        .sign-stop span { color: white; font-weight: 900; font-size: 32px; letter-spacing: 1px; }

        /* Yield (Inverted Triangle) */
        .sign-yield {
            width: 0; height: 0;
            border-left: 60px solid transparent;
            border-right: 60px solid transparent;
            border-top: 104px solid #cc0000;
            position: relative;
        }
        .sign-yield::after {
            content: ''; position: absolute;
            top: -98px; left: -45px;
            border-left: 45px solid transparent;
            border-right: 45px solid transparent;
            border-top: 78px solid white;
        }

        /* Priority (Diamond) */
        .sign-priority {
            width: 80px; height: 80px;
            background: #ffcc00;
            border: 8px solid white;
            outline: 2px solid black;
            transform: rotate(45deg);
            margin: 15px;
        }

        /* No Entry (Red Circle Bar) */
        .sign-no-entry {
            width: 110px; height: 110px;
            background: #cc0000;
            border: 2px solid white;
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
        }
        .sign-no-entry div { width: 70%; height: 20px; background: white; }

        /* Progress Bar */
        .progress-container { width: 100%; height: 4px; background: #1e293b; border-radius: 99px; margin-top: auto; overflow: hidden; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, #fbbf24, #d97706); transition: width 0.3s ease; }
    </style>
</head>
<body class="flex flex-col items-center justify-between p-4 max-w-md mx-auto h-full relative">

    <!-- Header -->
    <div class="w-full flex justify-between items-center z-10 pt-2 h-[50px] shrink-0">
        <div class="flex flex-col">
            <span class="text-[10px] text-slate-400 uppercase tracking-widest font-bold">Combo</span>
            <span id="combo-display" class="text-2xl font-black text-yellow-400 leading-none">x0</span>
        </div>
        <div class="flex flex-col items-end">
            <span class="text-[10px] text-slate-400 uppercase tracking-widest font-bold">Vite</span>
            <div id="lives-display" class="flex space-x-1 text-red-500 text-lg">
                <i class="fas fa-heart"></i><i class="fas fa-heart"></i><i class="fas fa-heart"></i>
            </div>
        </div>
    </div>

    <!-- Main Card -->
    <div id="quiz-container" class="flex-1 w-full flex flex-col justify-center relative my-2 min-h-0 w-full">
        
        <!-- Start Screen -->
        <div id="start-screen" class="absolute inset-0 flex flex-col items-center justify-center bg-slate-800 rounded-3xl p-6 text-center z-50 shadow-2xl border border-slate-700 start-content">
            <div class="mb-6">
                <i class="fas fa-bolt text-5xl text-yellow-500 mb-4 animate-bounce"></i>
                <h1 class="text-4xl font-black mb-1 leading-none"><span class="gradient-text">QUIZ<br>HACKER</span></h1>
                <h2 class="text-xs font-bold text-slate-500 tracking-[0.2em] mt-2">METODO 80/20</h2>
            </div>
            
            <div class="bg-slate-900/50 p-4 rounded-xl mb-6 w-full border border-slate-700 text-left">
                <div class="flex items-start gap-3 mb-3">
                    <i class="fas fa-eye text-blue-400 mt-1"></i>
                    <p class="text-xs text-slate-300">Leggi solo la <strong>parte evidenziata</strong>. √à il cuore della domanda.</p>
                </div>
                <div class="flex items-start gap-3">
                    <i class="fas fa-robot text-yellow-400 mt-1"></i>
                    <p class="text-xs text-slate-300"><strong>Nota:</strong> Le immagini dei segnali sono ricostruzioni digitali semplificate. All'esame ufficiale potrebbero variare.</p>
                </div>
            </div>

            <div class="space-y-3 w-full">
                <button onclick="startGame()" class="w-full py-4 bg-yellow-600 hover:bg-yellow-500 active:bg-yellow-700 rounded-2xl font-bold text-lg shadow-lg shadow-yellow-900/50 btn-press flex items-center justify-center gap-3 text-white">
                    <i class="fas fa-play"></i> Inizia Test
                </button>
            </div>
        </div>

        <!-- Question Card -->
        <div id="card" class="bg-slate-800 w-full rounded-3xl p-6 shadow-2xl border-t border-slate-700 hidden flex flex-col items-center justify-between h-full max-h-[550px]">
            
            <div class="w-full flex justify-between items-start mb-2 h-6">
                 <div id="boss-badge" class="hidden bg-red-600 text-white text-[9px] font-bold px-2 py-1 rounded mb-2 uppercase tracking-widest shadow-red-900/50 shadow-lg inline-block">
                    <i class="fas fa-skull"></i> Difficile
                </div>
                <div id="type-badge" class="bg-slate-700 text-slate-300 text-[9px] font-bold px-2 py-1 rounded mb-2 uppercase tracking-widest border border-slate-600 inline-block">
                    <!-- Type injected here -->
                </div>
            </div>

            <!-- CSS Sign Container -->
            <div id="sign-visual-container" class="w-full flex justify-center items-center h-40 mb-2">
                <!-- Generated CSS Sign goes here -->
            </div>

            <!-- Text -->
            <div id="question-text" class="text-center w-full break-words flex-1 flex flex-col justify-center">
                <!-- Content injected via JS -->
            </div>
            
            <!-- Footer -->
            <div class="w-full mt-4">
                 <div class="flex justify-between text-[10px] text-slate-500 uppercase mb-1 font-bold">
                    <span>Livello</span>
                    <span id="progress-text">1</span>
                </div>
                <div class="progress-container">
                    <div id="progress-bar" class="progress-bar" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <!-- Feedback -->
        <div id="feedback" class="absolute inset-0 hidden items-center justify-center z-40 rounded-3xl backdrop-blur-md bg-black/60 pointer-events-none">
            <div id="feedback-icon" class="text-9xl transform scale-0 transition-transform duration-200 drop-shadow-2xl"></div>
        </div>

    </div>

    <!-- Controls -->
    <div id="controls" class="w-full mt-2 mb-safe grid grid-cols-2 gap-3 hidden h-[140px] shrink-0">
        <button id="btn-false" onclick="handleAnswer(false)" class="h-full bg-slate-800 border-b-4 border-red-900 text-red-500 rounded-2xl font-black text-2xl active:border-b-0 active:translate-y-1 transition-all flex flex-col items-center justify-center group touch-none select-none outline-none focus:outline-none">
            <i class="fas fa-times text-3xl mb-1 group-active:scale-90 transition-transform"></i>
            <span>FALSO</span>
        </button>
        <button id="btn-true" onclick="handleAnswer(true)" class="h-full bg-slate-800 border-b-4 border-green-900 text-green-500 rounded-2xl font-black text-2xl active:border-b-0 active:translate-y-1 transition-all flex flex-col items-center justify-center group touch-none select-none outline-none focus:outline-none">
            <i class="fas fa-check text-3xl mb-1 group-active:scale-90 transition-transform"></i>
            <span>VERO</span>
        </button>
    </div>

    <!-- Game Over -->
    <div id="game-over" class="hidden absolute inset-0 bg-slate-900 z-50 flex flex-col items-center justify-center p-8 text-center">
        <div class="text-6xl mb-4 animate-bounce">üèÅ</div>
        <h2 class="text-3xl font-bold text-white mb-2">FINE PARTITA</h2>
        <div class="bg-slate-800 p-6 rounded-2xl w-full mb-8 border border-slate-700">
             <div class="flex justify-between text-slate-400 mb-2">
                <span>Risposte</span>
                <span id="final-count" class="text-white font-bold">0</span>
            </div>
            <div class="flex justify-between text-slate-400 border-t border-slate-700 pt-2">
                <span>Punteggio</span>
                <span id="final-score" class="text-yellow-400 font-bold text-xl">0</span>
            </div>
        </div>
        <button onclick="resetGame()" class="w-full py-4 bg-white text-slate-900 rounded-xl font-bold btn-press text-lg shadow-xl">Rigioca Subito</button>
    </div>

    <script>
        // --- DATABASE AGGIORNATO: NO SPOILER ---
        // highlight: deve essere una sottostringa ESATTA di text.
        // icons: usando fa-bus-simple per evitare confusione.
        const database = [
            // --- THEORY ---
            { text: "La patente di categoria B abilita a condurre le macchine agricole operatrici", isTrue: true, type: "theory", icon: "tractor", highlight: "macchine agricole operatrici" },
            { text: "L'autovettura √® un veicolo con massimo nove posti compreso il conducente", isTrue: true, type: "theory", icon: "car", highlight: "massimo nove posti" },
            { text: "I ciclomotori hanno cilindrata fino a 50 cm¬≥", isTrue: true, type: "theory", icon: "motorcycle", highlight: "fino a 50 cm¬≥" },
            { text: "Il casco √® obbligatorio per tutti i conducenti di motocicli", isTrue: true, type: "theory", icon: "helmet-safety", highlight: "casco √® obbligatorio" },
            { text: "√à vietato usare il cellulare alla guida senza auricolare", isTrue: true, type: "theory", icon: "mobile-screen", highlight: "senza auricolare" },
            { text: "La revisione dell'auto va fatta dopo 4 anni dalla prima immatricolazione", isTrue: true, type: "theory", icon: "wrench", highlight: "dopo 4 anni" },
            { text: "I neopatentati devono rispettare limiti di velocit√† specifici per 3 anni", isTrue: true, type: "theory", icon: "gauge", highlight: "limiti di velocit√† specifici" },
            { text: "La sosta √® vietata davanti ai passi carrabili", isTrue: true, type: "theory", icon: "ban", highlight: "davanti ai passi carrabili" },
            { text: "La patente a punti prevede la decurtazione di 20 punti per guida in stato di ebbrezza", isTrue: false, type: "theory", icon: "beer-mug-empty", highlight: "decurtazione di 20 punti" },
            { text: "Sulle autostrade il limite massimo √® di 150 km/h", isTrue: false, type: "theory", icon: "road", highlight: "limite massimo √® di 150 km/h" },
            { text: "I quadricicli leggeri possono andare in autostrada", isTrue: false, type: "theory", icon: "motorcycle", highlight: "possono andare in autostrada" },

            // --- PERICOLO ---
            { text: "Il segnale raffigurato preannuncia una curva a destra", isTrue: true, type: "danger", icon: "turn-up", rotateIcon: 90, highlight: "curva a destra" },
            { text: "Il segnale raffigurato preannuncia una curva a sinistra", isTrue: true, type: "danger", icon: "turn-up", rotateIcon: -90, highlight: "curva a sinistra" },
            { text: "Il segnale raffigurato preannuncia un dosso", isTrue: true, type: "danger", icon: "align-center", highlight: "dosso" }, 
            { text: "Il segnale raffigurato preannuncia la presenza di bambini", isTrue: true, type: "danger", icon: "child-reaching", highlight: "presenza di bambini" },
            { text: "Il segnale raffigurato preannuncia un semaforo", isTrue: true, type: "danger", icon: "traffic-light", highlight: "semaforo" },
            { text: "Il segnale raffigurato preannuncia lavori in corso", isTrue: true, type: "danger", icon: "person-digging", highlight: "lavori in corso" },
            { text: "Il segnale raffigurato preannuncia un attraversamento pedonale", isTrue: true, type: "danger", icon: "person-walking", highlight: "attraversamento pedonale" },
            { text: "Il segnale raffigurato preannuncia il passaggio di animali selvatici", isTrue: true, type: "danger", icon: "deer", highlight: "animali selvatici" },
            { text: "Il segnale raffigurato preannuncia strada sdrucciolevole", isTrue: true, type: "danger", icon: "car-burst", highlight: "strada sdrucciolevole" },
            
            // --- DIVIETO ---
            { text: "Il segnale raffigurato vieta il transito alle biciclette", isTrue: true, type: "prohibition", icon: "bicycle", highlight: "vieta il transito alle biciclette" },
            { text: "Il segnale raffigurato vieta il transito ai pedoni", isTrue: true, type: "prohibition", icon: "person-walking", highlight: "vieta il transito ai pedoni" },
            { text: "Il segnale raffigurato vieta il transito ai motocicli", isTrue: true, type: "prohibition", icon: "motorcycle", highlight: "vieta il transito ai motocicli" },
            { text: "Il segnale raffigurato vieta il transito agli autobus", isTrue: true, type: "prohibition", icon: "bus-simple", highlight: "vieta il transito agli autobus" },
            { text: "Il segnale raffigurato vieta il transito agli autocarri", isTrue: true, type: "prohibition", icon: "truck", highlight: "vieta il transito agli autocarri" },
            { text: "Il segnale raffigurato indica il limite massimo di velocit√† di 50 km/h", isTrue: true, type: "prohibition", textIcon: "50", highlight: "limite massimo di velocit√† di 50 km/h" },
            { text: "Il segnale raffigurato vieta il sorpasso", isTrue: true, type: "prohibition", icon: "car-side", color: "#1a1a1a", highlight: "vieta il sorpasso" },
            { text: "Il segnale raffigurato vieta il transito a tutti i veicoli", isTrue: true, type: "prohibition", icon: "circle", color: "white", highlight: "vieta il transito a tutti i veicoli" }, 
            
            // --- OBBLIGO ---
            { text: "Il segnale raffigurato indica direzione obbligatoria a destra", isTrue: true, type: "obligation", icon: "arrow-right", highlight: "direzione obbligatoria a destra" },
            { text: "Il segnale raffigurato indica una rotatoria", isTrue: true, type: "obligation", icon: "arrows-spin", highlight: "rotatoria" },
            { text: "Il segnale raffigurato indica un percorso pedonale", isTrue: true, type: "obligation", icon: "person-walking", highlight: "percorso pedonale" },
            { text: "Il segnale raffigurato indica una pista ciclabile", isTrue: true, type: "obligation", icon: "bicycle", highlight: "pista ciclabile" },
            { text: "Il segnale raffigurato indica il limite minimo di velocit√† di 30 km/h", isTrue: true, type: "obligation", textIcon: "30", highlight: "limite minimo di velocit√†" },

            // --- TRAPPOLE E SPECIALI ---
            { text: "Il segnale raffigurato obbliga a fermarsi e dare precedenza", isTrue: true, type: "stop", highlight: "obbliga a fermarsi" },
            { text: "Il segnale raffigurato indica di dare precedenza", isTrue: true, type: "yield", highlight: "dare precedenza" },
            { text: "Il segnale raffigurato vieta l'accesso", isTrue: true, type: "no_entry", highlight: "vieta l'accesso" },
            { text: "Il segnale raffigurato indica diritto di precedenza", isTrue: true, type: "priority", highlight: "diritto di precedenza" },

            // False (No spoiler in highlight)
            { text: "Il segnale raffigurato permette di passare senza fermarsi se l'incrocio √® libero", isTrue: false, type: "stop", highlight: "permette di passare senza fermarsi" },
            { text: "Il segnale raffigurato indica la presenza di una scuola", isTrue: false, type: "danger", icon: "child-reaching", highlight: "presenza di una scuola" },
            { text: "Il segnale raffigurato impone un limite minimo di velocit√†", isTrue: false, type: "prohibition", textIcon: "50", highlight: "limite minimo di velocit√†" },
            { text: "Il segnale raffigurato indica che la strada √® a senso unico", isTrue: false, type: "obligation", icon: "arrow-up", highlight: "strada √® a senso unico" },
            { text: "Il segnale raffigurato indica l'ingresso di uno zoo", isTrue: false, type: "danger", icon: "deer", highlight: "ingresso di uno zoo" }
        ];

        // --- GAME LOGIC ---
        let currentPool = [];
        let currentQuestion = null;
        let score = 0;
        let lives = 3;
        let combo = 0;
        let count = 0;

        function startGame() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('card').classList.remove('hidden');
            document.getElementById('card').classList.add('flex');
            document.getElementById('controls').classList.remove('hidden');
            document.getElementById('controls').classList.add('grid');
            
            lives = 3;
            combo = 0;
            score = 0;
            count = 0;
            updateStats();

            // Populate pool
            currentPool = [...database, ...database]; 
            currentPool.sort(() => Math.random() - 0.5);
            nextCard();
        }

        function nextCard() {
            if (currentPool.length === 0) {
                currentPool = [...database];
                currentPool.sort(() => Math.random() - 0.5);
            }

            currentQuestion = currentPool.pop();
            renderCard(currentQuestion);
            if(document.activeElement) document.activeElement.blur();
        }

        function renderCard(q) {
            const card = document.getElementById('card');
            const textContainer = document.getElementById('question-text');
            const visualContainer = document.getElementById('sign-visual-container');
            const typeBadge = document.getElementById('type-badge');
            const bossBadge = document.getElementById('boss-badge');
            
            // Anim reset
            card.classList.remove('card-enter', 'shake', 'boss-mode');
            void card.offsetWidth; card.classList.add('card-enter');

            // Draw Visual
            visualContainer.innerHTML = generateCSSSign(q);

            // Badges
            typeBadge.innerText = getTypeLabel(q.type);
            bossBadge.classList.toggle('hidden', q.isTrue); 

            // Text Logic (Smart Highlight)
            let html = '';
            if (q.highlight && q.text.includes(q.highlight)) {
                const parts = q.text.split(q.highlight);
                // Prendi solo la prima occorrenza per evitare problemi se la frase si ripete
                const prefix = parts[0];
                const suffix = parts.slice(1).join(q.highlight); 
                
                html = `
                    <div class="dimmed-text">${prefix}</div>
                    <div class="highlight-text">${q.highlight}</div>
                    <div class="dimmed-text">${suffix}</div>
                `;
            } else {
                html = `<div class="highlight-text">${q.text}</div>`;
            }
            textContainer.innerHTML = html;
            
            // Progress
            let progress = (count % 10) * 10; 
            document.getElementById('progress-bar').style.width = `${progress}%`;
            document.getElementById('progress-text').innerText = Math.floor(count / 10) + 1;
        }

        // --- THE CSS SIGN ENGINE ---
        function generateCSSSign(q) {
            if(q.type === 'theory') {
                return `<div class="w-24 h-24 rounded-full bg-slate-700/50 border-4 border-slate-600 flex items-center justify-center text-4xl text-blue-400"><i class="fas fa-${q.icon}"></i></div>`;
            }

            let innerContent = '';
            if (q.textIcon) {
                innerContent = `<span class="limit-text">${q.textIcon}</span>`;
            } else if (q.icon) {
                const rotation = q.rotateIcon ? `transform: rotate(${q.rotateIcon}deg);` : '';
                const color = q.color ? `color: ${q.color};` : '';
                innerContent = `<i class="fas fa-${q.icon}" style="${rotation} ${color}"></i>`;
            }

            switch(q.type) {
                case 'danger':
                    return `<div class="sign-danger">${innerContent}</div>`;
                case 'prohibition':
                    return `<div class="sign-prohibition">${innerContent}</div>`;
                case 'obligation':
                    return `<div class="sign-obligation">${innerContent}</div>`;
                case 'stop':
                    return `<div class="sign-stop"><span>STOP</span></div>`;
                case 'yield':
                    return `<div class="sign-yield"></div>`;
                case 'priority':
                    return `<div class="sign-priority"></div>`;
                case 'no_entry':
                    return `<div class="sign-no-entry"><div></div></div>`;
                default:
                    return '';
            }
        }

        function getTypeLabel(type) {
            const map = {
                'theory': 'TEORIA',
                'danger': 'PERICOLO',
                'prohibition': 'DIVIETO',
                'obligation': 'OBBLIGO',
                'stop': 'PRECEDENZA',
                'yield': 'PRECEDENZA',
                'priority': 'PRECEDENZA',
                'no_entry': 'DIVIETO'
            };
            return map[type] || 'QUIZ';
        }

        function handleAnswer(userChoice) {
            const btn = userChoice ? document.getElementById('btn-true') : document.getElementById('btn-false');
            btn.blur();
            const isCorrect = (userChoice === currentQuestion.isTrue);
            
            const feedbackIcon = document.getElementById('feedback-icon');
            const feedbackOverlay = document.getElementById('feedback');
            
            feedbackOverlay.classList.remove('hidden');
            feedbackOverlay.classList.add('flex');
            feedbackIcon.innerText = isCorrect ? 'üî•' : 'üíÄ';
            
            requestAnimationFrame(() => {
                feedbackIcon.classList.remove('scale-0');
                feedbackIcon.classList.add('scale-150');
            });

            if (isCorrect) {
                combo++; count++; score += (10 + combo * 2);
            } else {
                combo = 0; lives--;
                document.getElementById('card').classList.add('shake');
            }
            
            updateStats();

            setTimeout(() => {
                feedbackOverlay.classList.add('hidden');
                feedbackOverlay.classList.remove('flex');
                feedbackIcon.classList.remove('scale-150');
                feedbackIcon.classList.add('scale-0');
                
                if (lives <= 0) gameOver();
                else nextCard();
            }, 500);
        }

        function updateStats() {
            document.getElementById('combo-display').innerText = `x${combo}`;
            let hearts = '';
            for(let i=0; i<3; i++) hearts += (i < lives) ? '<i class="fas fa-heart"></i>' : '<i class="fas fa-heart-broken opacity-30"></i>';
            document.getElementById('lives-display').innerHTML = hearts;
        }

        function gameOver() {
            document.getElementById('game-over').classList.remove('hidden');
            document.getElementById('final-score').innerText = score;
            document.getElementById('final-count').innerText = count;
        }

        function resetGame() {
            document.getElementById('game-over').classList.add('hidden');
            document.getElementById('start-screen').classList.remove('hidden');
            document.getElementById('card').classList.add('hidden');
            document.getElementById('card').classList.remove('flex');
            document.getElementById('controls').classList.add('hidden');
            document.getElementById('controls').classList.remove('grid');
        }
    </script>
</body>
</html>
