<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SYNAPSE - Drive Core 2026</title>
    <style>
        /* --- RESET & VARIABLES --- */
        :root {
            --bg: #09090b;
            --surface: #18181b;
            --surface-glass: rgba(24, 24, 27, 0.7);
            --primary: #22d3ee; /* Cyan */
            --primary-glow: rgba(34, 211, 238, 0.4);
            --accent: #c084fc; /* Purple */
            --success: #4ade80;
            --error: #f43f5e;
            --text: #e4e4e7;
            --text-dim: #71717a;
            --font-main: 'Inter', system-ui, -apple-system, sans-serif;
            --font-mono: 'JetBrains Mono', 'Courier New', monospace;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }

        body {
            margin: 0;
            background-color: var(--bg);
            color: var(--text);
            font-family: var(--font-main);
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            user-select: none;
        }

        /* --- UI LAYER --- */
        .ui-layer {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none; /* Let clicks pass to canvas/game */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            z-index: 10;
            padding: 1.5rem;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            pointer-events: auto;
        }

        .brand {
            font-family: var(--font-mono);
            font-weight: 800;
            letter-spacing: -0.05em;
            font-size: 1.5rem;
            color: var(--text);
            text-shadow: 0 0 20px var(--primary-glow);
        }
        .brand span { color: var(--primary); }

        .stats {
            display: flex;
            gap: 1rem;
            font-family: var(--font-mono);
            font-size: 0.8rem;
            color: var(--text-dim);
            background: rgba(0,0,0,0.3);
            padding: 0.5rem 1rem;
            border-radius: 1rem;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .stat-item b { color: var(--text); margin-right: 4px; }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 4px;
            background: #27272a;
            border-radius: 2px;
            margin-top: 1rem;
            position: relative;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.5s cubic-bezier(0.22, 1, 0.36, 1);
            box-shadow: 0 0 10px var(--primary);
        }

        /* Footer / Context Info */
        .footer {
            text-align: center;
            pointer-events: auto;
        }
        .context-chip {
            background: var(--surface-glass);
            backdrop-filter: blur(10px);
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            border: 1px solid rgba(255,255,255,0.1);
            font-size: 0.75rem;
            color: var(--text-dim);
            display: inline-block;
            margin-bottom: 1rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            font-family: var(--font-mono);
            max-width: 80vw;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .tutorial-hint {
            color: var(--text-dim);
            font-size: 0.8rem;
            opacity: 0.6;
            margin-bottom: 5px;
            animation: pulse 2s infinite;
        }

        /* --- GAME LAYER --- */
        #game-container {
            position: absolute;
            inset: 0;
            z-index: 1;
            overflow: hidden;
            touch-action: none;
            background: radial-gradient(circle at center, #131316 0%, #09090b 100%);
        }

        /* Nodes */
        .node {
            position: absolute;
            transform: translate(-50%, -50%);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            border-radius: 1rem;
            transition: transform 0.1s, box-shadow 0.3s;
            cursor: pointer;
            will-change: transform, left, top;
        }

        .node-core {
            width: 160px;
            height: 160px;
            background: rgba(10, 10, 10, 0.9);
            border: 2px solid var(--primary);
            box-shadow: 0 0 40px var(--primary-glow);
            z-index: 5;
            color: white;
            font-weight: 700;
            font-size: 0.9rem;
            padding: 1rem;
            border-radius: 50%;
            flex-direction: column;
            overflow: hidden;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .node-core.active {
            border-color: #fff;
            box-shadow: 0 0 60px var(--primary);
            animation: pulse-border 1.5s infinite;
        }

        .node-core img {
            width: 80%;
            height: auto;
            max-height: 80px;
            object-fit: contain;
            margin-bottom: 0.5rem;
            border-radius: 4px;
        }

        .node-option {
            max-width: 150px;
            padding: 0.8rem 1rem;
            background: var(--surface);
            border: 1px solid #3f3f46;
            color: var(--text);
            font-size: 0.8rem;
            z-index: 4;
            border-radius: 1rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            user-select: none;
            line-height: 1.3;
        }

        .node-option:active {
            transform: translate(-50%, -50%) scale(0.95);
        }

        .node-option.connected {
            border-color: var(--success);
            background: rgba(74, 222, 128, 0.1);
            color: var(--success);
            box-shadow: 0 0 15px rgba(74, 222, 128, 0.2);
        }

        .node-option.wrong {
            border-color: var(--error);
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
            color: var(--error);
        }

        /* --- CANVAS --- */
        canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        /* --- ANIMATIONS --- */
        @keyframes pulse { 0% { opacity: 0.4; } 50% { opacity: 0.8; } 100% { opacity: 0.4; } }
        @keyframes pulse-border { 0% { box-shadow: 0 0 30px var(--primary); } 50% { box-shadow: 0 0 60px var(--primary), 0 0 10px #fff; } 100% { box-shadow: 0 0 30px var(--primary); } }
        @keyframes shake {
            10%, 90% { transform: translate(-52%, -50%); }
            20%, 80% { transform: translate(-48%, -50%); }
            30%, 50%, 70% { transform: translate(-54%, -50%); }
            40%, 60% { transform: translate(-46%, -50%); }
        }

        /* Overlay Messages */
        .overlay-msg {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            font-size: 3rem;
            font-weight: 900;
            color: white;
            text-shadow: 0 0 20px rgba(0,0,0,0.5);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s, transform 0.3s;
            z-index: 20;
            text-transform: uppercase;
            font-family: var(--font-mono);
            white-space: nowrap;
        }
        .overlay-msg.show { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        .text-success { color: var(--success); text-shadow: 0 0 30px rgba(74, 222, 128, 0.6); }
        .text-error { color: var(--error); text-shadow: 0 0 30px rgba(244, 63, 94, 0.6); }

    </style>
</head>
<body>

    <!-- UI LAYER -->
    <div class="ui-layer">
        <div>
            <div class="header">
                <div class="brand">SYNAPSE<span>.</span></div>
                <div class="stats">
                    <div class="stat-item"><b id="score-display">0</b> PTS</div>
                    <div class="stat-item" style="color:var(--primary)"><b id="streak-display">0</b> STRK</div>
                </div>
            </div>
            <div class="progress-container">
                <div id="progress-bar" class="progress-fill"></div>
            </div>
        </div>

        <div class="footer">
            <div id="tutorial-txt" class="tutorial-hint">Tocca il NUCLEO per attivare il collegamento</div>
            <div id="context-chip" class="context-chip">CARICAMENTO DATI...</div>
        </div>
    </div>

    <!-- GAME MESSAGES -->
    <div id="msg-overlay" class="overlay-msg"></div>

    <!-- GAME CONTAINER -->
    <div id="game-container">
        <canvas id="connections-canvas"></canvas>
    </div>

    <script>
        /* * =========================================
         * IMAGE ASSETS MAPPING
         * =========================================
         */
        const IMAGE_MAP = {
            "001": "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Italian_traffic_signs_-_pericolo_-_strada_deformata.svg/240px-Italian_traffic_signs_-_pericolo_-_strada_deformata.svg.png",
            "002": "https://upload.wikimedia.org/wikipedia/commons/thumb/2/22/Italian_traffic_signs_-_pericolo_-_dosso.svg/240px-Italian_traffic_signs_-_pericolo_-_dosso.svg.png",
            "003": "https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Italian_traffic_signs_-_pericolo_-_cunetta.svg/240px-Italian_traffic_signs_-_pericolo_-_cunetta.svg.png",
            "004": "https://upload.wikimedia.org/wikipedia/commons/thumb/7/77/Italian_traffic_signs_-_pericolo_-_curva_a_destra.svg/240px-Italian_traffic_signs_-_pericolo_-_curva_a_destra.svg.png",
            "005": "https://upload.wikimedia.org/wikipedia/commons/thumb/6/64/Italian_traffic_signs_-_pericolo_-_curva_a_sinistra.svg/240px-Italian_traffic_signs_-_pericolo_-_curva_a_sinistra.svg.png",
            "006": "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a3/Italian_traffic_signs_-_pericolo_-_doppia_curva_di_cui_la_prima_a_destra.svg/240px-Italian_traffic_signs_-_pericolo_-_doppia_curva_di_cui_la_prima_a_destra.svg.png",
            "007": "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e3/Italian_traffic_signs_-_pericolo_-_doppia_curva_di_cui_la_prima_a_sinistra.svg/240px-Italian_traffic_signs_-_pericolo_-_doppia_curva_di_cui_la_prima_a_sinistra.svg.png"
        };

        /* * =========================================
         * DATA ENGINE
         * =========================================
         */
        
        const RAW_DATA = `
Listato A B 2026
Metodo:  Raggruppamento per radice testuale (Pattern Matching)
Lezione: 01.1 Definizioni stradali e di traffico
Argomento: La strada
La strada è...
[ F ] ...riservata alla circolazione dei soli autoveicoli e motocicli
[ V ] ...aperta alla circolazione dei pedoni, degli animali e dei veicoli
[ F ] ...qualsiasi area asfaltata, limitata lateralmente dagli attraversamenti pedonali 
[ F ] …normalmente riservata alla circolazione dei soli veicoli e animali
La strada può...
[ V ] ...comprendere le piste ciclabili
[ V ] ...essere suddivisa in carreggiate
[ V ] ...essere a doppio senso di circolazione
[ V ] ...essere a senso unico di circolazione
La strada non comprende...
[ F ] ...i marciapiedi
[ F ] ...le banchine
Argomento: La carreggiata
La carreggiata è...
[ F ] ...destinata soltanto alla circolazione di carri a trazione animale
[ V ] ...la parte della strada destinata normally alla circolazione dei veicoli
[ F ] ...destinata alla sosta degli autocarri
[ F ] ...la traccia lasciata dalle ruote dei veicoli sulle strade innevate
[ F ] ...destinata alla sosta di emergenza
La carreggiata può...
[ V ] ...essere a senso unico di circolazione
[ V ] ...essere suddivisa in corsie
[ V ] ...essere a doppio senso di circolazione
Fanno parte della carreggiata...
[ V ] ...le corsie di sorpasso
[ V ] ...le corsie di marcia
[ V ] ...gli attraversamenti pedonali
[ V ] ...gli attraversamenti ciclabili
[ F ] ...i marciapiedi
[ F ] ...le banchine
[ F ] ...le corsie di emergenza delle autostrade
La carreggiata non comprende...
[ V ] ...non comprende le piste ciclabili
[ V ] ...non comprende i marciapiedi 
[ F ] ...comprende le piazzole di sosta
Argomento: La corsia
La corsia è...
[ V ] ...limitata da strisce continue o discontinue
[ V ] ...una parte della carreggiata che consente la circolazione di una sola fila di veicoli
[ F ] ...formata da due carreggiate
[ F ] ...una strada a scorrimento veloce
[ F ] ...destinata solo al transito dei pedoni
[ F ] ...una pista riservata alle vetture da corsa
La corsia può...
[ F ] ...essere a doppio senso di circolazione
[ V ] ...essere destinata alla normale marcia dei veicoli
[ V ] ...essere destinata ad effettuare sorpassi
[ V ] ...essere destinata al rallentamento dei veicoli in uscita dalle autostrade
[ V ] ...essere destinata alle soste di emergenza, in caso di guasto o malessere
[ V ] ...essere riservata ai veicoli che intendono svoltare (corsia specializzata)
[ V ] ...essere riservata alla circolazione di alcune categorie di veicoli (taxi, autobus, ecc.)
[ V ] ...essere di accelerazione
[ V ] ...essere di decelerazione

La corsia di accelerazione...
[ V ] ...facilita l'ingresso dei veicoli in autostrada o su strade extraurbane principali
[ V ] ...serve ad entrare correttamente in autostrada
[ F ] ...serve per abbandonare la carreggiata dell’autostrada ed entrare in un’area di sosta
[ V ] ...serve per rientrare sulla carreggiata dell’autostrada dopo che si è usciti da un’area di servizio
[ V ] ...viene utilizzata per aumentare la velocità
[ F ] ...serve per uscire da una piazzola di sosta
[ F ] ...può essere utilizzata per il sorpasso
La corsia di decelerazione...
[ V ] ...facilita l'uscita dei veicoli dall'autostrada
[ F ] ...può essere utilizzata per la sosta dei veicoli
[ V ] ...serve per uscire correttamente da una strada extraurbana principale
[ V ] ...serve per uscire dalla carreggiata dell’autostrada ed entrare nell’area di servizio
[ F ] ...serve ad entrare in autostrada
[ F ] ...serve per entrare in una piazzola di sosta
Fuori dai centri abitati...
[ F ] ...su una stessa corsia possono circolare affiancati due ciclomotori
Nei centri abitati...
[ F ] ...su una stessa corsia possono circolare affiancati due motocicli
Le corsie possono...
[ V ] ...essere vietate a taluni tipi di veicoli
L'ente proprietario della strada può...
[ V ] ...imporre che su una corsia i veicoli transitino ad una velocità minima obbligatoria
Argomento: Intersezioni a raso e a livelli sfalsati
L'intersezione (incrocio) a raso...
[ V ] ...richiede di fare attenzione ai veicoli provenienti dalle strade che si incrociano
[ V ] ...è un'intersezione di due o più strade poste allo stesso livello
[ F ] ...è un incrocio fra una strada statale e un passo carrabile
[ F ] ...è un passaggio a livello dotato di barriere o semibarriere
[ F ] ...è un incrocio fra una strada statale e i binari del tram
[ V ] ...può essere regolata da semaforo
[ F ] ...è un'intersezione a livelli sfalsati
[ F ] ...è un insieme di sovrappassi, sottopassi e rampe
Nell'intersezione (incrocio) a...
[ V ] ...raso due o più strade si incrociano allo stesso livello
[ F ] ...livelli sfalsati non valgono i limiti massimi generali di velocità
L'intersezione (incrocio) a livelli sfalsati...
[ V ] ...è munita di infrastrutture (rampe, sovrappassi, sottopassi) per il collegamento fra strade poste a livelli diversi
[ V ] ...comprende strade situate ad altezze diverse
[ V ] ...facilita la circolazione, perché esclude l'incrocio diretto fra i veicoli
[ V ] ...comprende rampe, sovrappassi o sottopassi
[ F ] ...è, di norma, regolata da semafori
[ F ] ...un incrocio a raso fra una strada e i binari del treno
Argomento: Passaggi a livello ed attraversamenti Tranviari
In un passaggio a livello si possono trovare...
[ V ] ...le luci rosse
[ V ] ...le semibarriere
[ V ] ...le barriere
[ F ] ...le corsie di accelerazione
[ F ] ...le luci gialle lampeggianti
Il passaggio a livello è...
[ F ] ...un passo carrabile
[ F ] ...caratterizzato dalla presenza di un attraversamento autostradale
[ F ] ...caratterizzato dalla presenza di un sottopassaggio
[ F ] ...un cavalcavia ferroviario o tranviario
In un passaggio a livello si può trovare...
[ V ] ...la croce di S. Andrea
[ V ] ...un dispositivo di segnalazione acustica
In vicinanza di un passaggio a livello...
[ V ] ...si trovano i pannelli distanziometrici
Bisogna lasciare liberi...
[ V ] ...i passaggi a livello e i binari del tram anche in caso di traffico intenso
Argomento: Banchine e marciapiedi
La banchina è...
[ F ] ...riservata ai veicoli lenti, nelle strade in salita
[ V ] ...parte della strada, situata oltre la linea bianca continua di margine della carreggiata
[ V ] ...parte della strada, posta al di fuori della carreggiata
[ F ] ...parte della carreggiata, destinata alla sosta dei veicoli
Sulle banchine...
[ F ] ...la sosta dei veicoli è consentita per un massimo di 5 ore
La banchina non consente...
[ V ] ...di norma, il transito ai veicoli
Il marciapiede è...
[ V ] ...una parte della strada riservata, di norma, ai pedoni
[ V ] ...una parte della strada, rialzata o delimitata in altro modo, riservata ai pedoni
[ F ] ...una parte della strada dove, di norma, è consentita la sosta dei ciclomotori
[ V ] ...una parte della strada, al di fuori della carreggiata, destinata alla circolazione dei pedoni
[ F ] ...una parte della carreggiata
[ F ] ...una parte della strada riservata anche alle biciclette
[ F ] ...riservato ai pedoni e ai veicoli in sosta, qualora non sia rialzato
Il marciapiede consente...
[ V ] ...la sosta dei veicoli solo in presenza di apposite strisce di parcheggio
Il conducente del motociclo...
[ F ] ...può circolare sul marciapiede se il traffico sulla carreggiata è bloccato
Argomento: Attraversamenti pedonali e ciclabili
L'attraversamento pedonale è...
[ V ] ...una parte della carreggiata, in cui i veicoli devono dare la precedenza ai pedoni, che attraversano sulle apposite strisce
[ V ] ...una parte della carreggiata destinata al transito dei pedoni che attraversano
[ F ] ...posto al di fuori della carreggiata ed è destinato al transito dei pedoni
[ F ] ...una parte della carreggiata vietata al transito dei veicoli
[ F ] ...una parte della strada, separata dalla carreggiata mediante una striscia gialla
[ V ] ...una parte della carreggiata sulla quale è vietata la sosta dei veicoli
[ V ] ...una parte della carreggiata sulla quale è vietata la fermata dei veicoli
[ F ] ...una parte della carreggiata in cui è consentita la fermata ma non la sosta dei veicoli
L'attraversamento pedonale non fa parte...
[ F ] ...della carreggiata
L'uso corretto della strada comporta che...
[ V ] ...si dia la precedenza ai pedoni che attraversano sugli attraversamenti pedonali
[ F ] ...ci si arresti sempre ai passaggi pedonali ripartendo solo se non sopraggiungono pedoni
L'attraversamento pedonale viene segnalato...
[ V ] ...con strisce bianche parallele
Bisogna lasciare liberi...
[ V ] ...gli attraversamenti pedonali e quelli ciclabili in caso di formazione di code di veicoli
Argomento: Passo carrabile, Piazzola di Sosta, Parcheggio
Il passo carrabile è...
[ F ] ...una strada riservata ai carri trainati da animali
[ F ] ...una strada riservata agli autocarri
[ F ] ...un segnale che impone la circolazione rotatoria su una piazza
[ F ] ...un salvagente circolare per i pedoni
[ F ] ...un parcheggio scambiatore
[ V ] ...una zona per l’accesso dei veicoli alle proprietà laterali alla strada
Il passo carrabile consente...
[ V ] ...ai veicoli di accedere alle proprietà private laterali alla strada (garage, cortili, ecc.)
Il passo carrabile permette...
[ V ] ...ai veicoli che circolano su una strada pubblica di accedere ad un'area laterale adibita alla sosta
Il passo carrabile deve essere...
[ V ] ...corredato da apposito segnale, che riporti l'ente e il numero di autorizzazione
In corrispondenza del passo carrabile...
[ F ] ...è consentita la sosta
[ V ] ...è consentita la fermata
Argomento: Isola di traffico e Salvagente
L'isola di traffico è...
[ F ] ...una zona destinata al parcheggio dei veicoli
[ F ] ...posta al di fuori della strada
[ F ] ...una piazzola di sosta per i veicoli
[ F ] ...un'area pedonale urbana
[ F ] ...corrisponde, in genere, al centro storico della città
[ F ] ...una piazzola per effettuare l'inversione di marcia
[ F ] ...una parte della strada sulla quale è consentito il transito dei ciclomotori
[ F ] ...la parte della città con maggiore traffico
[ V ] ...una parte della strada sulla quale è vietato il transito dei veicoli
[ V ] ...una parte della strada sulla quale è vietato il transito dei motocicli
L'isola di traffico serve...
[ F ] ...per la fermata dei veicoli
[ F ] ...a separare la carreggiata dalla banchina
[ F ] ...per il transito dei pedoni
[ V ] ...a facilitare l'incanalamento dei veicoli verso varie direzioni
L'isola di traffico può essere...
[ F ] ...percorsa solo dai taxi e dagli autobus urbani
[ V ] ...a raso o in rilievo (rialzata)
L'isola di traffico viene evidenziata...
[ V ] ...mediante zebrature di colore bianco
L'isola di traffico a raso...
[ V ] ...è costituita da zebrature di colore bianco
L'isola di traffico facilita...
[ F ] ...la salita e la discesa di passeggeri da tram, filobus e autobus
L'isola di traffico, se rialzata...
[ V ] ...è preceduta da zebrature di colore bianco
L'isola di traffico è delimitata...
[ V ] ...da strisce bianche continue
Il salvagente è...
[ F ] ...una persona preposta al primo soccorso
[ F ] ...un itinerario ciclopedonale
Il salvagente facilita...
[ V ] ...la salita e la discesa dei passeggeri da tram, filobus o autobus
Il salvagente, posto in corrispondenza...
[ V ] ...di attraversamenti pedonali, serve anche al riparo o alla sosta dei pedoni che attraversano la strada
Il salvagente può essere segnalato...
[ V ] ...da colonnine luminose a luce gialla fissa
Il salvagente serve a...
[ F ] ...incanalare i veicoli in varie direzioni
[ F ] ...dividere i sensi di marcia in una strada a doppio senso di circolazione
Argomento: Zona a traffico limitato e Area Pedonale
Una zona a traffico limitato è...
[ F ] ...un'area nella quale è consentito solo il transito di ciclomotori e biciclette
[ F ] ...un'area vietata al transito dei pedoni durante le ore notturne
[ V ] ...delimitata da appositi segnali stradali di inizio e di fine
[ F ] ...un'area sempre vietata al transito dei veicoli a motore
[ V ] ...un'area nella quale può essere limitata la circolazione solo a particolari categorie di utenti
[ V ] ...un'area nella quale può essere limitata la circolazione solo di particolari categorie di veicoli
[ V ] ...un'area in cui può essere limitata la circolazione dei veicoli solo in alcune ore
In una zona a traffico limitato...
[ V ] ...possono circolare solo i veicoli autorizzati
[ F ] ...non possono entrare più di un certo numero di veicoli
Nelle aree pedonali...
[ F ] ...i ciclomotori possono transitare solo di giorno
[ V ] ...possono transitare i pedoni
[ F ] ...possono transitare i quadricicli a motore, purché non superino la velocità di 50 km/h
[ F ] ...possono transitare i trattori stradali, con velocità non superiore a 30 km/h
[ F ] ...possono transitare tutti gli autoveicoli, ma con prudenza
[ F ] ...possono transitare tutti i motocicli, purché diano la precedenza ai pedoni
[ V ] ...possono transitare i veicoli al servizio di persone diversamente abili
[ V ] ...possono transitare le biciclette
[ V ] ...possono transitare gli autoveicoli dei vigili del fuoco, con luce lampeggiante blu e sirena in funzione
[ V ] ...possono transitare i veicoli della polizia, con sirena e luce lampeggiante blu in funzione
[ V ] ...possono transitare i veicoli ad emissione zero (elettrici), se espressamente consentito
Lezione: 01.2 Doveri del conducente nell'uso della strada, convivenza civile ed uso responsabile della strada
Argomento: Divieti generali 
Spostare la segnaletica...
[ V ] ...stradale può comportare pericolo grave per gli altri utenti della strada
È vietato...
[ V ] ...spostare o imbrattare la segnaletica stradale
[ V ] ...rimuovere la segnaletica stradale
[ V ] … danneggiare le opere e gli impianti stradali
[ V ] ...sporcare la carreggiata depositando rifiuti
[ V ] ...gettare oggetti e rifiuti dai veicoli in movimento
[ F ] ...parcheggiare nelle zone residenziali
[ V ] ...lanciare dal finestrino mozziconi di sigaretta accesi
[ V ] ...spargere fango o detriti sulle strade con le ruote sporche dei veicoli
[ V ] ...immettersi sulle strade con le ruote del veicolo sporche di fango
E' consentito spostare...
[ F ] ...la segnaletica stradale, se si tratta delle barriere di delimitazione o dei coni stradali
[ F ] ...la segnaletica stradale, se non si tratta di segnali di pericolo
[ F ] ...la segnaletica stradale, dopo aver avvisato gli organi di polizia
[ F ] ...i segnali stradali verticali temporanei per parcheggiare il veicolo
Il conducente può...
[ F ] ...lanciare oggetti dal finestrino sulla banchina
[ F ] ...superare i veicoli in coda accelerando bruscamente e cambiando ripetutamente corsia
E' consentito lanciare...
[ F ] ...la carta dal finestrino
Su tutte le strade...
[ F ] ...è vietato il transito dei veicoli che superano 10 m di lunghezza
[ F ] ...è vietato esercitarsi alla guida
[ F ] ...sono vietati gli avvisatori acustici (clacson, trombe)
Gettare mozziconi...
[ V ] ...accesi dai finestrini in prossimità di boschi o aree verdi potrebbe causare incendi
[ V ] ...di sigaretta accesi dai finestrini è molto pericoloso soprattutto se sopraggiungono veicoli a due ruote
Sulle strade pubbliche sono consentite...
[ F ] ...le gare di velocità, anche se non autorizzate, dalle ore 23.00 alle ore 6.00
[ F ] ...le gare di velocità, anche se non autorizzate, tra motocicli e non tra autoveicoli
Sono consentite le gare di velocità...
[ F ] ...anche se non autorizzate, purché partecipino solo due autovetture
Le competizioni sportive...
[ F ] ...con veicoli su aree pubbliche sono consentite senza autorizzazione
È punito con la reclusione...
[ V ] ...il conducente che gareggia in velocità su strade pubbliche
[ V ] ...chi scommette su veicoli che partecipano a gare di velocità non autorizzate su strade pubbliche
[ V ] ...il conducente che partecipa a gare di velocità non autorizzate su aree pubbliche
Sulle strade è vietato gareggiare...
[ V ] ...in velocità
Il conducente che si accorge...
[ V ] ...che il suo veicolo perde olio deve compiere tutte le azioni necessarie per evitare pericoli per altri utenti
[ V ] ...che il suo veicolo ha forti perdite di olio o carburante, deve immediatamente avvisare l’ente proprietario della strada o gli organi di polizia
Uscendo da un sentiero fangoso...
[ V ] ...o da un cantiere, bisogna assicurarsi che durante la marcia non cada terriccio che possa sporcare la strada
Per evitare di sporcare...
[ V ] ...la carreggiata, bisogna pulire le ruote del veicolo, prima di uscire da un sentiero fangoso
Se, uscendo da un sentiero fangoso...
[ V ] ...si sporca notevolmente la strada, si può incorrere in una sanzione amministrativa
Su una strada ricoperta...
[ F ] ...da brecciolino il conducente può circolare a velocità sostenuta
Alla guida di un veicolo...
[ V ] ...il conducente deve procedere a bassa velocità sopra le pozzanghere
Argomento: Convivenza Civile ed Uso Responsabile della Strada
Entrando in un centro abitato...
[ V ] ...bisogna tenere conto che può cambiare spesso la precedenza agli incroci
[ V ] ...bisogna continuare a mantenere la concentrazione alla guida anche se potrebbero aumentare i motivi per distrarsi
[ F ] ...bisogna considerare che è possibile sostare in corrispondenza di incroci non regolati
[ V ] ...bisogna tenere conto che il flusso della circolazione viene spesso intralciato o interrotto da veicoli che sono fermi, che partono o che cambiano direzione
Entrati in un centro abitato...
[ V ] ...bisogna tenere conto che gli altri utenti della strada (quali pedoni e ciclisti) si mescolano maggiormente con il traffico motorizzato
Il conducente di un veicolo...
[ F ] ...può approfittare della potenza del proprio veicolo per non dare la precedenza a chi spetta
[ F ] ...di grandi dimensioni ha, di norma, la precedenza sul conducente di un veicolo più piccolo
[ F ] ...può fare a meno di usare la massima prudenza quando si avvicina ad un incrocio in cui ha il diritto di precedenza
[ V ] ...oltre a rispettare le norme specifiche della circolazione, deve tenere un rapporto corretto e tollerante verso gli altri utenti della strada
[ V ] ...deve essere paziente e tollerante anche in caso di rallentamento della circolazione
[ V ] ...deve tutelare la propria e l'altrui sicurezza
[ V ] ...deve cercare di prevedere il comportamento degli altri utenti
[ V ] ...non deve fare sempre affidamento sul comportamento degli altri, che può non essere corretto
[ V ] ...diverso dai taxi non può sostare nei posteggi riservati ai taxi
[ F ] ...diverso dai taxi può sostare nei posteggi riservati ai taxi dalle ore 20.00 alle ore 8.00
Il conducente deve...
[ F ] ...dare segni di impazienza, se il veicolo che sta davanti procede troppo lentamente
[ F ] ...concentrarsi prevalentemente sul tratto di strada non superiore a tre metri antistante il suo veicolo
In un centro abitato...
[ F ] ...è sempre consentita la marcia per file parallele
[ V ] ...bisogna essere più attenti, prudenti e tolleranti, a causa del maggior numero di utenti che interagiscono nell'ambiente urbano
[ F ] ...bisogna considerare che i pedoni e i diversamente abili devono sempre dare la precedenza ai veicoli a motore
Quando si viaggia in fila...
[ V ] ...con altri veicoli, non bisogna limitarsi a osservare solamente il veicolo che precede, ma occorre porre attenzione anche in lontananza, per controllare la situazione del traffico
[ V ] ...con altri veicoli, bisogna mantenere ugualmente la distanza di sicurezza
[ V ] ...con altri veicoli, è opportuno non avvicinarsi troppo al veicolo che precede
[ F ] ...con altri veicoli è consentito distrarsi se si è a bassa velocità
[ F ] ...con altri veicoli, è opportuno tenere sempre accese le luci di emergenza
[ F ] ...con altri veicoli, è opportuno spostarsi al centro della carreggiata, per controllare la situazione del traffico
[ F ] ...con altri veicoli, è opportuno spostarsi il più possibile a sinistra, per creare una corsia libera a destra
Anche in condizioni di scarsa visibilità...
[ F ] ...quando si viaggia dietro ad un veicolo che solleva polvere, conviene sorpassarlo subito
Un incidente...
[ V ] ...anche a bassa velocità, potrebbe creare gravi problemi fisici a pedoni, ciclisti e motociclisti, se coinvolti
[ F ] ...a bassa velocità non crea problemi di incolumità ai conducenti coinvolti
Lezione: 01.3 Definizioni e Classificazione dei Veicoli
Argomento: Ciclomotori
I ciclomotori...
[ V ] ...sono soggetti a revisione dopo quattro anni dalla prima immatricolazione, successivamente ogni due anni
[ V ] ...possono avere due o tre ruote
[ F ] ...non sono soggetti a revisione periodica
[ F ] ...non hanno più di due ruote
[ F ] ...possono circolare alla velocità di 60 km/h fuori dai centri urbani
[ F ] ...per essere definiti tali, devono essere muniti di cambio manuale
[ V ] ...a due ruote non possono avere un motore termico di cilindrata superiore a 50 cm3
[ V ] ...non rientrano nella categoria dei motocicli
I veicoli a due ruote...
[ V ] ...con motore termico fino a 50 cm3 di cilindrata e velocità massima di 45 km/h sono ciclomotori
Non tutti i veicoli a motore...
[ V ] ...a due ruote vengono classificati ciclomotori
Si definiscono ciclomotori tutti i veicoli...
[ F ] ...a due ruote di cilindrata superiore a 50 cm3
Le biciclette con pedalata assistita...
[ F ] ...dotate di motore elettrico ausiliario di potenza massima fino a 0,25 kW, sono definite ciclomotori
E' consentito...
[ F ] ...aumentare la cilindrata dei quadricicli leggeri purché non si aumenti la velocità
[ F ] ...sostituire il motore del quadriciclo leggero per aumentare la velocità massima oltre i 45 km/h
[ F ] ...sostituire il dispositivo di scarico dei quadricicli leggeri per aumentare la velocità massima, purché non si aumenti la cilindrata del motore
I quadricicli leggeri... 
[ V ] ...alimentati a benzina hanno cilindrata del motore inferiore o pari a 50 cm3
[ V ] ...ai fini della circolazione, sono assimilati ai ciclomotori 
La guida dei quadricicli non leggeri...
[ F ] ...è consentita già al compimento del quattordicesimo anno di età
Ai fini della circolazione i quadricicli leggeri sono assimilati...
[ F ] ...ai motocicli
Argomento: Motoveicoli
I motocicli...
[ V ] ...sono soggetti a revisione dopo quattro anni dalla prima immatricolazione, successivamente ogni due anni
[ V ] ...possono essere dotati di cambio automatico
[ V ] ...hanno cilindrata superiore a 50 cm3
[ V ] ...sono veicoli a due ruote
[ F ] ...hanno motore di cilindrata fino a 50 cm3 e sviluppano una velocità fino a 45 km/h
[ F ] ...sono veicoli a motore con più di due ruote
Tutti i veicoli a motore con tre ruote...
[ F ] ...sono dei motocicli
Si definiscono motocicli solo i veicoli...
[ F ] ...a due ruote di cilindrata fino a 125 cm3
Il motociclo è...
[ F ] ...un qualunque veicolo a due ruote
I tricicli a motore sono...
[ F ] ...veicoli a motore che possono essere condotti senza patente
[ V ] ...soggetti a revisione dopo quattro anni dalla prima immatricolazione, successivamente ogni due anni
[ F ] ...non soggetti a revisione periodica
[ V ] ...veicoli a motore a tre ruote simmetriche
[ F ] ...costituiti da un motociclo e un sidecar
[ V ] ...veicoli a motore aventi una velocità massima per costruzione superiore a 45 km/h
[ V ] ...veicoli con motore di cilindrata superiore a 50 cm3
[ F ] ...veicoli con motore di cilindrata inferiore a 50 cm3 e aventi velocità massima per costruzione fino a 45 km/h
I quadricicli...
[ V ] ...sono veicoli a motore a quattro ruote
[ V ] ...sono soggetti a revisione periodica
[ F ] ...non sono soggetti a revisione periodica
[ F ] ...non leggeri a manubrio e con carrozzeria aperta possono essere condotti senza casco
[ F ] ...diversi da quelli leggeri possono essere guidati senza patente
[ F ] ...non leggeri, ai fini della circolazione, sono equiparati ai ciclomotori
[ V ] ...non sono autoveicoli
La potenza dei quadricicli non leggeri è sempre...
[ V ] ...inferiore o uguale a 15 kW
Il triciclo a motore è...
[ F ] ...un autoveicolo
Argomento: Autoveicoli
Gli autoveicoli sono...
[ F ] ...tutti i veicoli con almeno due ruote
[ F ] ...tutti i veicoli con almeno quattro ruote, compresi quelli senza motore
[ V ] ...veicoli a motore con almeno quattro ruote, esclusi i quadricicli
[ F ] ...tutti i veicoli a motore con quattro o più ruote, compresi i quadricicli
L'autoveicolo è...
[ F ] ...un qualunque veicolo adibito al trasporto di merce
[ F ] ...un qualunque veicolo a motore
[ V ] ...un veicolo a motore con non meno di quattro ruote, eccetto i quadricicli
Le autovetture...
[ V ] ...possono avere motore elettrico 
[ V ] ...sono soggette a revisione periodica
[ F ] ...sono soggette a revisione ogni cinque anni 
[ F ] ...non possono trainare carrelli-appendice o rimorchi
L'autovettura...
[ F ] ...è un veicolo con dieci posti in totale, compreso il conducente
[ V ] ...è un veicolo a motore con quattro ruote, destinato al trasporto di massimo nove persone, compreso il conducente 
[ V ] ...fa parte degli autoveicoli 
[ F ] ...può avere al massimo, cinque posti 
[ V ] ...non può avere più di nove posti, compreso il conducente
Vengono definite autovetture tutti i veicoli...
[ F ] ...con motore anteriore
Si definiscono autovetture tutti i veicoli...
[ F ] ...a motore che hanno la trazione posteriore
Si definisce autovettura il veicolo...
[ F ] ...blindato e appositamente attrezzato per il trasporto di valori
Le autocaravan (camper) sono...
[ F ] ...veicoli destinati ai lavori agricoli
[ V ] ...veicoli aventi una speciale carrozzeria per essere adibiti al trasporto ed all'alloggio al massimo del numero di persone indicato nella carta di circolazione
[ V ] ...veicoli aventi una speciale carrozzeria per essere adibiti al trasporto ed all'alloggio di persone
[ F ] ...veicoli destinati alla costruzione e alla manutenzione di opere stradali
[ V ] ...veicoli attrezzati permanentemente per essere adibiti al trasporto ed all'alloggio di persone
[ F ] ...rimorchi
[ V ] ...soggette a revisione periodica
[ F ] ...soggette a revisione ogni cinque anni
Sulle autocaravan (camper) è possibile viaggiare...
[ F ] ...in piedi, solo per brevi tratti
L'autobus...
[ V ] ...viene classificato autoveicolo 
[ V ] ...non è un'autovettura 
L'autocarro è...
[ V ] ...un autoveicolo
[ F ] ...un'autovettura
Argomento: Macchine agricole e Macchine Operatrici
Sulle macchine agricole e sui loro rimorchi è consentito...
[ F ] ...il trasporto di persone in piedi
Le macchine agricole...
[ V ] ...possono essere a ruote o a cingoli
[ F ] ...possono trasportare fino a quattro passeggeri
[ V ] ...possono essere semoventi o trainate
[ V ] ...possono circolare su strada per il proprio trasferimento se immatricolate
[ V ] ...a ruote o a cingoli possono circolare su strada per il trasporto di prodotti agricoli per conto delle aziende agricole e forestali
Con la patente di categoria A si possono guidare...
[ F ] ...tutte le macchine agricole
Le macchine operatrici...
[ V ] ...possono essere veicoli sgombraneve
[ F ] ...possono circolare ad una velocità superiore a 50 km/h
[ V ] ...possono essere semoventi o trainate
[ V ] ...possono essere dotate di speciali attrezzature per l'esecuzione di operazioni agricole
[ F ] ...semoventi possono trasportare fino a quattro passeggeri
[ F ] ...a cingoli possono circolare ad una velocità superiore a 45 km/h
Per condurre macchine operatrici è necessario essere titolari della patente di guida...
[ F ] ...della categoria A
Con la patente di categoria B si possono guidare...
[ F ] ...le macchine operatrici eccezionali
Argomento: Rimorchi e semirimorchi
I rimorchi leggeri sono...
[ F ] ...quelli di massa massima a pieno carico fino a 500 kg
[ V ] ...quelli di massa massima a pieno carico fino a 750 kg
I rimorchi sono...
[ F ] ...muniti di silenziatore
I rimorchi o i semirimorchi sono...
[ V ] ...veicoli privi di motore, destinati ad essere trainati
I semirimorchi sono...
[ F ] ...rimorchi privi di impianto frenante
I caravan (roulottes) sono...
[ F ] ...rimorchi destinati ai lavori agricoli
[ V ] ...rimorchi attrezzati per essere adibiti ad alloggio
[ V ] ...muniti di targa
[ F ] ...rimorchi destinati esclusivamente al trasporto di attrezzature turistiche e sportive
[ V ] ...utilizzabili come alloggio solo con veicolo fermo
E' possibile alloggiare...
[ F ] ...nei caravan (roulottes) durante la circolazione
Il caravan non è...
[ F ] ...un rimorchio
L'autocaravan non è...
[ V ] ...un rimorchio
L'autosnodato non è classificato...
[ V ] ...rimorchio
Lezione: 01.4 Riguardo verso gli utenti deboli della strada (anziani, diversamente abili, bambini, pedoni, ciclisti)
Argomento: Comportamenti a salvaguardia degli anziani, ciechi e sordociechi
Bisogna usare maggiore prudenza nei confronti...
[ V ] ...delle persone anziane
[ V ] ...dei bambini che attraversano la strada
[ V ] ...delle persone diversamente abili
[ V ] ...delle persone in bicicletta e di quelle con scarsa capacità di movimento
[ V ] ...dei conducenti che dimostrano una guida incerta
[ V ] ...dei conducenti di veicoli adattati per persone diversamente abili
[ F ] ...dei pedoni muniti di bastone bianco, ma non di quelli con bastone bianco-rosso
[ F ] ...dei conducenti di autoveicoli elettrici
[ F ] ...dei conducenti di taxi
[ F ] ...dei conducenti di tricicli a motore
[ V ] ...delle donne in stato di gravidanza che attraversano la strada
[ V ] ...dei pedoni che spingono una carrozzina per bambini
Bisogna usare particolare prudenza nei confronti dei conducenti che hanno conseguito la patente di guida...
[ F ] ...in uno Stato estero
Quando le persone anziane attraversano la carreggiata bisogna...
[ F ] ...lampeggiare e suonare il clacson per farle attraversare rapidamente
[ V ] ...tenere presente che potrebbero fermarsi improvvisamente al centro della strada
[ V ] ...tenere presente che potrebbero non fare adeguata attenzione ai veicoli
[ F ] ...dare la precedenza solo a coloro che attraversano da sinistra a destra
[ V ] ...tenere presente che, data la loro età, non reagiscono prontamente alle situazioni di pericolo
[ V ] ...tenere presente che potrebbero non guardare né a destra, né a sinistra
[ V ] ...non avvicinarsi troppo con il veicolo, per evitare che si sentano minacciati e reagiscano con movimenti pericolosi
[ F ] ...tenere presente che, di solito, attraversano rapidamente e con prudenza
[ F ] ...tenere presente che hanno i riflessi più rapidi e quindi attraversano con più accortezza
[ F ] ...tenere presente che, avendo più esperienza e un campo visivo maggiore, intuiscono meglio le situazioni di pericolo
Le persone anziane che attraversano la carreggiata sono...
[ V ] ...esposte a maggiori pericoli, perché le loro capacità visive e uditive non sono più eccellenti
[ V ] ...esposte a maggiori pericoli, perché potrebbero valutare male la velocità dei veicoli che sopraggiungono
Se un pedone con bastone bianco attraversa la strada fuori dalle strisce pedonali...
[ F ] ...bisogna suonare il clacson per sollecitarlo ad attraversare rapidamente
Il conducente deve...
[ V ] ...fermarsi quando un pedone non vedente con il bastone bianco si accinge ad attraversare la strada, evitando di frenare bruscamente per non spaventarlo
[ V ] ...fermarsi e facilitare l'attraversamento al pedone non vedente con il bastone bianco che attraversa la strada fuori dalle strisce pedonali
[ V ] ...fermarsi e dare la precedenza al pedone non vedente con il bastone bianco che si accinge ad attraversare la strada fuori dalle strisce pedonali
[ V ] ...fermarsi per concedere la precedenza al pedone sordocieco che, con il bastone bianco-rosso, attraversa la strada fuori dalle strisce pedonali
[ V ] ...dare la precedenza al pedone non vedente con il bastone bianco che attraversa la strada fuori dalle strisce pedonali, anche se non è accompagnato da un cane guida
[ V ] ...dare la precedenza al pedone con il bastone bianco o bianco-rosso che attraversa la strada, anche se è fuori dalle strisce di un attraversamento pedonale
[ F ] ...accelerare per sgombrare rapidamente la carreggiata quando un pedone non vedente con il bastone bianco attraversa la strada senza cane guida
[ F ] ...passare per primo, in quanto ha la precedenza, quando un pedone non vedente con il bastone bianco attraversa la strada fuori dalle strisce pedonali
[ F ] ...prevedere che un pedone non vedente con il bastone bianco che attraversa la strada fuori dalle strisce pedonali camminerà rapidamente e senza incertezza
[ F ] ...dare la precedenza a un pedone non vedente che attraversa la strada fuori dalle strisce pedonali, solo se munito di bastone bianco-rosso
[ V ] ...consentire ad una donna incinta di attraversare la strada senza metterle fretta
Il conducente, quando un pedone non vedente con il bastone bianco attraversa la strada fuori dalle strisce pedonali...
[ F ] ...deve dargli la precedenza solo se l'attraversamento pedonale dista oltre 100 metri
In vicinanza di un attraversamento pedonale,...
[ F ] ...il conducente deve considerare che un pedone munito di bastone bianco ha più esperienza su come attraversare la carreggiata
[ F ] ...il conducente deve arrestarsi se il pedone che attraversa è munito di bastone bianco-rosso; deve solo rallentare se, invece, è munito di bastone bianco
[ V ] ...il conducente deve considerare che le reazioni dei bambini che attraversano sono imprevedibili e, quindi, possono creare pericolo
[ V ] ...il conducente deve considerare che i bambini potrebbero avanzare sulle strisce, per poi tornare indietro improvvisamente, senza motivo apparente
[ V ] ...il conducente deve considerare che i pedoni, in special modo i bambini, possono sbucare all'improvviso tra i veicoli parcheggiati
[ V ] ...il conducente deve considerare che i veicoli parcheggiati in prossimità delle strisce impediscono la visuale dei pedoni
[ F ] ...il conducente deve aspettarsi dai bambini una reazione rapida e un comportamento corretto
[ V ] ...il conducente deve considerare che le persone anziane solitamente attraversano lentamente e con difficoltà
[ V ] ...il conducente deve considerare che il pedone potrebbe fermarsi improvvisamente sulle strisce dell'attraversamento pedonale
[ F ] ...il conducente deve accelerare quel tanto che basta per passare davanti al pedone che attraversa
[ V ] ...il conducente deve considerare che il pedone, nell'attraversare la strada, può diventare insicuro e ritornare improvvisamente indietro
[ F ] ...il conducente deve considerare che i pedoni devono attraversare la strada affiancati, in modo da impiegare meno tempo
[ F ] ...il conducente deve considerare che se il pedone si è fermato in mezzo alle strisce dell'attraversamento significa che ha rinunciato al suo diritto di passare
[ F ] ...i pedoni devono fare un cenno con la mano prima di iniziare l'attraversamento
Argomento: Comportamento a salvaguardia dei bambini e donne incinte
Quando vi sono bambini fermi al semaforo...
[ V ] ...bisogna usare prudenza perché può accadere che si spingano a vicenda, finendo sulla carreggiata
[ V ] ...bisogna usare prudenza perché potrebbero scendere dal marciapiede, invadendo la carreggiata, quando ancora per loro il semaforo è disposto al rosso
[ V ] ...bisogna usare prudenza in quanto potrebbero attraversare improvvisamente la strada appena la luce del semaforo veicolare passa dal verde al giallo
[ V ] ...bisogna usare prudenza in quanto potrebbero attraversare velocemente la strada anche con il rosso, ritenendo che duri troppo 
[ F ] ...bisogna tenere presente che possono attraversare la strada solo se accompagnati da un adulto
[ F ] ...si può essere certi che non attraverseranno la strada se il semaforo è a luce gialla lampeggiante
[ F ] ...si può essere certi che attraverseranno la strada solo quando il semaforo pedonale abbia la luce verde accesa
I bambini, al semaforo, possono attraversare la strada...
[ F ] ...solo dopo aver ricevuto un gesto di consenso da parte degli automobilisti
Prima di impegnare un incrocio, dopo che è scattata la luce verde del semaforo...
[ V ] ...il conducente deve attendere che i pedoni abbiano finito di attraversare la strada
Alla guida di un veicolo, in vicinanza di una piazzola di fermata di autobus che trasporta/per scolari,...
[ V ] …occorre fare attenzione ai bambini che potrebbero aver iniziato ad attraversare la carreggiata nascosti dall'autobus 
[ V ] ...occorre essere prudenti e tenere conto dei comportamenti imprevedibili dei bambini
[ V ] ...occorre fare attenzione ai bambini, che potrebbero attraversare di corsa la strada per salire sullo scuolabus
[ V ] ...occorre prepararsi a frenare, nel caso in cui dei bambini attraversino improvvisamente la strada
[ F ] ...non è necessario rallentare se lo scuolabus è fermo
[ F ] ...occorre suonare per invitare i bambini che attraversano sulle strisce a dare la precedenza
[ F ] ...non si deve rallentare, per evitare di ostacolare la circolazione degli altri veicoli
[ F ] ...si deve rallentare solo se vi sono bambini che attraversano
[ V ] ...bisogna rallentare particolarmente se vi è lo scuolabus
[ F ] ...occorre fare attenzione allo scuolabus, che dopo la fermata farà sicuramente retromarcia
[ F ] ...occorre passare per primi, avendo sempre la precedenza sui bambini che attraversano la strada
[ F ] ...non si può proseguire nella marcia se le portiere dello scuolabus sono ancora aperte
In vicinanza di una piazzola di fermata di autobus per scolari...
[ V ] ...può accadere che i bambini scendano dall'autobus senza fare attenzione ai veicoli che sopraggiungono
Quando una donna in stato di gravidanza attraversa la carreggiata...
[ F ] ...bisogna darle la precedenza solo se attraversa da sinistra a destra
[ F ] ...bisogna tenere presente che ha il passo più rapido e quindi attraversa velocemente 
[ V ] ...non bisogna avvicinarsi troppo con il veicolo, per evitare di spaventarla
E' consentito posteggiare un veicolo davanti agli scivoli del marciapiede...
[ F ] ...solo dalle ore 22.00 alle ore 8.00
Quando un pedone che spinge la/una carrozzina per bambini attraversa la carreggiata...
[ F ] ...bisogna dargli la precedenza solo se attraversa da sinistra a destra
[ F ] ...bisogna tenere presente che, di solito, attraversa rapidamente
Quando si parcheggia un veicolo è vietato ostruire...
[ V ] ...eventuali scivoli del marciapiede per non impedire il passaggio di pedoni che spingono una carrozzina per bambini
E' consentito lasciare il veicolo in sosta sul marciapiede...
[ F ] ...senza lasciare spazio ai pedoni che spingono una carrozzina per bambini
Argomento: Comportamenti a salvaguardia dei Pedoni e dei ciclisti 
Il conducente, di notte...
[ F ] ...non deve dare la precedenza ai pedoni che attraversano sulle strisce pedonali
Quando la carreggiata è occupata da ciclisti o pedoni...
[ V ] ...per sorpassarli è prudente mantenere un'adeguata distanza di sicurezza laterale
[ V ] ...non è prudente sorpassarli se non si può rispettare una distanza laterale sufficiente
[ F ] ...si devono sorpassare senza superare la velocità di 30 km/h
E' vietato sorpassare...
[ F ] ...ciclisti o pedoni che occupano la carreggiata
Poiché la marcia dei ciclisti a volte avviene con leggeri sbandamenti...
[ V ] ...il conducente di un veicolo deve tener conto di tale particolarità, in caso di sorpasso
Il conducente che intende sorpassare ciclisti o pedoni che occupano la carreggiata...
[ V ] ...deve usare molta prudenza
[ F ] ...deve mantenere una distanza laterale di almeno 2 metri
Quando la carreggiata extraurbana è occupata da ciclisti o pedoni...
[ V ] ...è consigliabile suonare il clacson prima di sorpassarli
Il conducente, in vicinanza di un posteggio riservato ai taxi...
[ V ] ...deve fare attenzione ai pedoni, che possono attraversare improvvisamente la strada senza le dovute precauzioni
[ V ] ...deve fare attenzione ai pedoni che salgono o scendono dal taxi
[ V ] ...deve rallentare ed eventualmente fermarsi se vi sono pedoni che attraversano la strada, senza guardare
[ F ] ...deve dare la precedenza ai taxi in partenza, qualora s'immettano dal lato sinistro della carreggiata
[ F ] ...deve dare la precedenza ai taxi che s'immettono sulla strada
Lezione: 02.1 Segnali di Pericolo
Argomento: Strada deformata (001)
Il segnale raffigurato  (001)  è un segnale di...
[ V ] ...pericolo
[ F ] ...prescrizione
Il segnale raffigurato  (001)  preannuncia...
[ F ] ...più curve consecutive
[ F ] ...una discesa pericolosa
[ V ] ...un tratto di strada deformata
[ V ] ...un tratto di strada con pavimentazione irregolare
[ V ] ...un tratto di strada dissestata
[ V ] ...una strada in cattivo stato
[ F ] ...una serie di dossi
[ F ] ...una forte variazione di pendenza della strada
[ F ] ...un tratto di strada a visibilità limitata
[ F ] ...un dosso
[ F ] ...una doppia curva
Il segnale raffigurato  (001) ... 
[ V ] ...si trova, in genere, 150 metri prima di un tratto di strada con fondo irregolare
[ V ] ...può essere associato con un segnale di limite massimo di velocità
[ V ] …se a fondo giallo è usato in presenza di cantieri stradali
[ F ] ...indica un tratto di strada deformata lungo 320 metri (902)
[ V ] ...indica un tratto di strada deformata lungo 380 metri (901) 
In presenza del segnale raffigurato  (001) ...
[ V ] ...è necessario tenere saldamente il volante, per controllare possibili sbandamenti
[ V ] ...è importante prevedere eventuali sbandamenti dei veicoli provenienti dal senso opposto
[ F ] ...è necessario fare attenzione al restringimento della carreggiata
[ F ] ...è obbligatorio circolare al centro della carreggiata
[ V ] ...è necessario circolare a velocità moderata se si traina un rimorchio 
Argomento: Dosso (002)
Il segnale raffigurato  (002)  è un segnale di...
[ V ] ...è un segnale di pericolo
[ F ] ...è un segnale di obbligo
[ F ] ...è un segnale di precedenza 
Il segnale raffigurato  (002)  preannuncia...
[ F ] ...l'ingresso in una galleria
[ V ] ...un dosso
[ V ] ...una salita, seguita da una discesa
[ V ] ...una variazione di pendenza della strada con limitata visibilità
[ F ] ...un tratto di strada deformata
[ F ] ...un tratto di strada con pavimentazione irregolare
[ F ] ...un ponte
[ F ] ...una cunetta
[ F ] ...un tratto di strada in cattivo stato
[ V ] ...un tratto di strada pericoloso per limitata visibilità
[ F ] ...lavori in corso
Il segnale raffigurato  (002) ... 
[ V ] ...è posto, di norma, 150 metri prima di un dosso
[ F ] ...vieta il transito degli autobus
[ V ] ...può presegnalare dossi artificiali
In presenza del segnale raffigurato  (002) ...
[ V ] ...bisogna considerare che la visibilità è limitata
[ V ] ...è necessario moderare la velocità in relazione alla visibilità
[ V ] ...è vietato il sorpasso sul tratto in salita, se la strada è a doppio senso di circolazione con due sole corsie
[ F ] ...è vietato il sorpasso nel tratto in discesa
[ V ] ...sono vietate la sosta e la fermata sia sul tratto in salita che su quello in discesa
[ F ] ...è possibile effettuare l'inversione di marcia nel tratto in discesa
[ V ] ...è vietata l'inversione di marcia
Argomento: Cunetta (003)
Il segnale raffigurato  (003)  preannuncia... 
[ F ] ...un dosso
[ V ] ...un tratto di strada pericoloso a causa di una cunetta
[ V ] ...una cunetta
[ F ] …un tratto di strada in cattivo stato
[ F ] ...un tratto di strada con pavimentazione irregolare
[ V ] ...un tratto di strada che potrebbe allagarsi in caso di forti piogge
[ F ] ...una banchina cedevole
[ F ] ...un restringimento della carreggiata
[ F ] ...una strada deformata
Il segnale raffigurato  (003) ... 
[ V ] ...è un segnale di pericolo
[ V ] ...si trova prima di un tratto in discesa seguito da uno in salita
[ F ] ...può trovarsi prima di un tratto in salita seguito da una discesa
[ F ] ...indica una banchina cedevole
In presenza del segnale raffigurato  (003) ...
[ V ] ...è necessario moderare la velocità per mantenere il controllo del veicolo
[ V ] ...è necessario moderare la velocità per evitare danni alle sospensioni
[ V ] ...è necessario tenere il volante con una presa più sicura
[ V ] ...e in caso di pioggia è necessario prevedere la possibilità di accumulo di acqua nella cunetta
[ V ] ...è necessario prevedere la possibilità di accumulo di fango e detriti nella cunetta
[ F ] ...è necessario rallentare solo se provengono veicoli dal senso opposto
[ F ] ...è vietato il sorpasso se si circola in una strada a senso unico
[ F ] ...non è necessario rallentare se la cunetta presenta visibilità
Argomento: Curva pericolosa a destra (004)
Il segnale raffigurato  (004)  preannuncia...
[ F ] ...un cambio di corsia
[ V ] ...una curva pericolosa a destra
[ F ] ...una curva a sinistra
[ V ] ...un tratto di strada pericoloso per ridotta visibilità
[ F ] ...un obbligo di svolta a destra
[ V ] ...un tratto di strada pericoloso
[ F ] ...una serie di curve pericolose di cui la prima a destra
[ V ] ...un tratto di strada in cui è necessario regolare la velocità in relazione alla visibilità e al raggio della curva
[ V ] ...un tratto di strada in cui è necessario percorrere la curva con più attenzione se la strada è bagnata
[ F ] ...un tratto di strada in cui è consentito sorpassare i motocicli, anche superando di poco la striscia bianca continua
[ F ] ...un tratto di strada in cui è consentito sorpassare i motocicli, anche invadendo la corsia opposta
[ F ] ...un tratto di strada a due corsie e doppio senso di circolazione in cui è consentito sorpassare i motocicli, senza superare la striscia bianca continua
[ V ] ...un tratto di strada in cui non è consentito il sorpasso se la carreggiata è a doppio senso di circolazione e con due sole corsie
[ F ] ...un tratto di strada in salita
[ F ] ...un tratto di strada in cui è consentita la fermata, ma non la sosta
[ F ] ...un tratto di strada in cui è consentito effettuare l'inversione di marcia
[ F ] ...un tratto di strada in cui è consentito effettuare manovre di retromarcia
Il segnale raffigurato  (004) ... 
[ V ] ...richiede di moderare la velocità
[ F ] ...è posto, di norma, a 5 metri dall'inizio della curva
[ V ] ...è posto, di norma, a 150 metri dal punto di inizio della curva
[ F ] ...è un segnale di prescrizione
[ V ] ...può essere integrato con pannello con la scritta TORNANTE
[ F ] …posto su una strada a doppio senso di circolazione, impone di portarsi sulla parte sinistra della carreggiata per affrontare meglio la curva
In presenza del segnale raffigurato  (004) ...
[ F ] ...si deve circolare il più possibile vicino alla striscia bianca che separa i sensi di marcia
[ V ] ...si deve viaggiare ad andatura particolarmente moderata se si circola con il ruotino (ruota di soccorso) 
[ V ] ...posto su strada a doppio senso di circolazione e con due sole corsie, si deve circolare il più possibile vicino al margine destro
Argomento: Curva pericolosa a sinistra (005)
La figura rappresenta  (005) ...
[ V ] ...un segnale di pericolo
[ F ] ...un divieto di svolta a sinistra
[ F ] ...un segnale di obbligo
[ F ] ...un segnale di prescrizione
Il segnale raffigurato  (005)  preannuncia...
[ V ] ...un tratto di strada che curva a sinistra con limitata visibilità
[ V ] ...una curva pericolosa a sinistra
[ V ] ...di norma a 150 metri, una curva pericolosa
[ V ] ...un tratto di strada pericoloso per ridotta visibilità
[ V ] ...un tratto di strada non rettilineo, che limita la visibilità
[ F ] ...un ostacolo da aggirare a sinistra
Il segnale raffigurato  (005) ...
[ F ] ...indica una deviazione per cantiere di lavoro
[ F ] ...indica una circolazione rotatoria
[ F ] ...impone di circolare il più vicino possibile al centro della strada
[ F ] ...impone l'obbligo di mantenere la sinistra
[ V ] ...richiede di moderare la velocità per potersi arrestare in caso di un ostacolo improvviso
In presenza del segnale raffigurato  (005) ...
[ V ] ...è necessario regolare la velocità in relazione alla visibilità e al raggio della curva
[ V ] ...si deve viaggiare ad andatura particolarmente moderata se si circola con il "ruotino" (ruota di soccorso)
[ V ] ...non è consentito sorpassare altri veicoli su una carreggiata a doppio senso di circolazione con due sole corsie
[ F ] ...è consentito effettuare l'inversione di marcia
[ F ] ...è consentita la fermata ma non la sosta
[ F ] ...è consentito effettuare manovre di retromarcia
[ V ] ...è necessario percorrere la curva con più attenzione se la strada è bagnata
[ F ] ...non è consentito il transito ai veicoli con il "ruotino" (ruota di soccorso)
[ V ] ...su una strada a doppio senso di circolazione con due sole corsie, si deve circolare il più possibile vicino al margine destro
[ F ] ...su strada a doppio senso di circolazione a due corsie, è consentito sorpassare i motocicli senza invadere la corsia opposta
[ F ] ...su strada a senso unico di circolazione si deve marciare il più possibile vicino al margine destro della carreggiata
Argomento: Doppia curva pericolosa la prima a destra (006)
La figura rappresenta  (006) ...
[ V ] ...un segnale di pericolo
Il segnale raffigurato  (006) ... 
[ V ] ...può essere integrato con il pannello in figura (906)
[ V ] ...può essere integrato con un pannello indicante TORNANTI
[ V ] ...richiede di moderare la velocità per potersi arrestare in caso di un ostacolo improvviso
Il segnale raffigurato  (006)  preannuncia...
[ V ] ...di norma a 150 metri, una doppia curva pericolosa
[ F ] ...un raccordo di uscita autostradale
[ F ] ...una deviazione per lavori in corso
[ F ] ...un incrocio
[ F ] ...una discesa pericolosa
[ F ] ...un tratto di strada con superficie sdrucciolevole
[ F ] ...un tratto di strada con pavimentazione irregolare
[ V ] ...un tratto di strada non rettilineo che limita la visibilità
[ V ] ...una doppia curva pericolosa, la prima a destra
[ F ] ...un tratto di strada in cui è consentita l'inversione di marcia
[ F ] ...un tratto di strada in cui è consentita la manovra di retromarcia
Il segnale con il pannello in figura  (006)  preannuncia...
[ F ] ...un tratto di strada lungo 3,8 km con una serie di curve pericolose (905) 
In presenza del segnale raffigurato  (006) ...
[ V ] ...è necessario regolare la velocità in relazione alla visibilità e al raggio delle curve
[ V ] ...è necessario percorrere le curve con più attenzione in caso di pioggia
[ V ] ...è necessario regolare la velocità in relazione alle condizioni di carico del veicolo
[ F ] ...è necessario tenere una velocità moderata esclusivamente nella prima curva
[ V ] ...bisogna moderare la velocità
[ F ] ...è consentito effettuare la fermata in curva
[ F ] ...è consentito sorpassare motocicli e ciclomotori su strada a due corsie e a doppio senso di circolazione
[ F ] ...posto su strada a due corsie e a doppio senso di circolazione, è consentito sorpassare nelle ore diurne
Su strada a due (sole) corsie e a doppio senso di circolazione, in presenza del segnale raffigurato  (006) ...
[ V ] ...è opportuno fare particolare attenzione ai veicoli provenienti dal senso opposto
[ V ] ...si deve marciare il più possibile vicino al margine destro
Nella curve pericolose preannunciate dal segnale raffigurato  (006) ...
[ V ] ...è vietato il sorpasso se la carreggiata è a due corsie e a doppio senso di circolazione
Argomento: Doppia curva pericolosa la prima a sinistra (007)
La figura rappresenta  (007) ...
[ V ] ...un segnale di pericolo
Il segnale raffigurato  (007) ...
[ V ] ...richiede di moderare la velocità
Il segnale raffigurato preannuncia  (007) ...
[ F ] ...una deviazione per lavori in corso
[ F ] ...un tratto di strada con una serie di dossi
[ F ] ...un tratto di carreggiata sdrucciolevole
[ F ] ...una strettoia
[ F ] ...un tratto di strada deformata
[ V ] ...in genere a 150 m, una doppia curva pericolosa
[ V ] ...un tratto di strada non rettilineo che limita la visibilità
[ V ] ...una doppia curva pericolosa, la prima a sinistra
[ F ] ...una confluenza a sinistra
[ V ] ...la presenza di tornanti se integrato con apposito pannello
In presenza del segnale raffigurato  (007) ...
[ V ] ...è necessario regolare la velocità in relazione alla visibilità e al raggio delle curve
[ F ] ...è consentita la manovra di retromarcia
[ V ] ...è necessario percorrere le curve con più attenzione in caso di pioggia
[ F ] ...è consentita l'inversione di marcia
[ F ] ...è consentito effettuare la fermata in corrispondenza delle curve
[ V ] ...è necessario regolare la velocità in relazione alle condizioni di carico del veicolo
[ V ] ...è opportuno fare particolare attenzione ai veicoli provenienti dal senso opposto
[ V ] ...non è consentito effettuare manovre di sorpasso su strade a due sole corsie e a doppio senso di circolazione
[ F ] ...è consentito sorpassare motocicli e ciclomotori su strade a due corsie e a doppio senso
[ V ] ...si deve circolare il più vicino possibile al margine destro della carreggiata, su strada a due sole corsie e a doppio senso di circolazione
[ F ] ...è necessario tenere una velocità moderata esclusivamente nella prima curva
[ F ] ...posto su strade a due corsie e a doppio senso, è consentito sorpassare un veicolo molto lento 
`;

        class DataParser {
            static parse(text) {
                const lines = text.split('\n');
                const levels = [];
                let currentTopic = "Generale";
                let currentRoot = null;
                let currentQuestions = [];

                lines.forEach(line => {
                    line = line.trim();
                    if (!line) return;

                    // 1. Detect Topic
                    if (line.startsWith('Argomento:') || line.startsWith('Lezione:')) {
                        currentTopic = line.replace('Argomento:', '').replace('Lezione:', '').trim();
                        return;
                    }

                    // 2. Detect Answer
                    if (line.startsWith('[ V ]') || line.startsWith('[ F ]')) {
                        if (!currentRoot) return;
                        const isTrue = line.startsWith('[ V ]');
                        // Clean the text (remove [ V ] and leading ...)
                        let txt = line.substring(5).trim();
                        if (txt.startsWith('...')) txt = txt.substring(3).trim();
                        
                        currentQuestions.push({
                            text: txt,
                            isTrue: isTrue,
                            id: Math.random().toString(36).substr(2, 9)
                        });
                    } else if (line.endsWith('...') || line.endsWith(':')) {
                        // 3. Detect Root (Question)
                        // If we have a previous grouping, save it
                        if (currentRoot && currentQuestions.length > 0) {
                            levels.push(this.packageLevel(currentTopic, currentRoot, currentQuestions));
                        }
                        // Start new grouping
                        currentRoot = line;
                        currentQuestions = [];
                    }
                });

                // Push last set
                if (currentRoot && currentQuestions.length > 0) {
                    levels.push(this.packageLevel(currentTopic, currentRoot, currentQuestions));
                }
                
                return levels;
            }

            static packageLevel(topic, rootText, answers) {
                // Check for image code e.g., (001) in rootText
                let imageId = null;
                const match = rootText.match(/\((\d{3})\)/);
                if (match) {
                    imageId = match[1];
                }

                return {
                    topic: topic,
                    root: rootText,
                    imageId: imageId,
                    answers: [...answers]
                };
            }
        }

        /* * =========================================
         * GAME ENGINE
         * =========================================
         */

        class Game {
            constructor() {
                this.container = document.getElementById('game-container');
                this.canvas = document.getElementById('connections-canvas');
                this.ctx = this.canvas.getContext('2d');
                
                // UI Elements
                this.scoreEl = document.getElementById('score-display');
                this.streakEl = document.getElementById('streak-display');
                this.barEl = document.getElementById('progress-bar');
                this.contextEl = document.getElementById('context-chip');
                this.msgOverlay = document.getElementById('msg-overlay');

                // State
                this.levels = DataParser.parse(RAW_DATA);
                this.currentLevelIndex = 0;
                this.score = 0;
                this.streak = 0;
                this.currentNodes = [];
                this.coreNode = null;
                this.connections = []; 
                this.completedTrueCount = 0;
                this.totalTrueCount = 0;

                // Interaction State
                this.isConnecting = false;
                this.pointerPos = { x: 0, y: 0 };
                this.center = { x: window.innerWidth/2, y: window.innerHeight/2 };

                this.initListeners();
                this.startLevel();
                this.resize();
                this.loop();
            }

            resize() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
                this.center = { x: window.innerWidth/2, y: window.innerHeight/2 };
                
                // FORCE RE-CENTER CORE
                if (this.coreNode) {
                    this.coreNode.x = this.center.x;
                    this.coreNode.y = this.center.y;
                    this.updateDOMPos(this.coreNode);
                }
            }

            initListeners() {
                window.addEventListener('resize', () => this.resize());
                
                // Track mouse/touch globally for line drawing
                const handleMove = (e) => {
                    const x = e.clientX || (e.touches && e.touches[0].clientX);
                    const y = e.clientY || (e.touches && e.touches[0].clientY);
                    if (x && y) this.pointerPos = { x, y };
                };
                
                this.container.addEventListener('mousemove', handleMove);
                this.container.addEventListener('touchmove', handleMove);

                // Click background to cancel
                this.container.addEventListener('click', (e) => {
                    if (e.target === this.container || e.target === this.canvas) {
                        this.cancelConnection();
                    }
                });
            }

            cancelConnection() {
                this.isConnecting = false;
                if (this.coreNode && this.coreNode.el) {
                    this.coreNode.el.classList.remove('active');
                }
            }

            startLevel() {
                // Cleanup
                this.container.querySelectorAll('.node').forEach(el => el.remove());
                this.connections = [];
                this.currentNodes = [];
                this.isConnecting = false;

                // Pick Level
                const levelData = this.levels[Math.floor(Math.random() * this.levels.length)];
                
                // Setup Core
                this.coreNode = this.createNode(levelData.root, true, levelData);
                this.coreNode.x = this.center.x;
                this.coreNode.y = this.center.y;
                
                this.contextEl.textContent = levelData.topic.toUpperCase();

                // Setup Options
                let options = levelData.answers.sort(() => 0.5 - Math.random()).slice(0, 6);
                this.totalTrueCount = options.filter(o => o.isTrue).length;
                this.completedTrueCount = 0;
                
                if (this.totalTrueCount === 0 && levelData.answers.some(a=>a.isTrue)) {
                   options[0] = levelData.answers.find(a=>a.isTrue);
                   this.totalTrueCount = 1;
                }

                // Spawn positions (Orbit)
                // Use smaller radius on mobile to prevent overflow
                const isMobile = window.innerWidth < 600;
                const radius = Math.min(window.innerWidth, window.innerHeight) * (isMobile ? 0.28 : 0.35);
                const angleStep = (2 * Math.PI) / options.length;

                options.forEach((opt, index) => {
                    const angle = index * angleStep - Math.PI/2; 
                    const node = this.createNode(opt.text, false, opt);
                    
                    node.baseAngle = angle;
                    node.radius = radius;
                    node.floatOffset = Math.random() * 100;
                    
                    // Initial pos
                    node.x = this.center.x + Math.cos(angle) * radius;
                    node.y = this.center.y + Math.sin(angle) * radius;
                    
                    this.currentNodes.push(node);
                });

                this.updateProgressBar();
                // Force initial position update
                this.resize();
            }

            createNode(text, isCore, data = null) {
                const el = document.createElement('div');
                el.className = isCore ? 'node node-core' : 'node node-option';
                
                if (isCore && data.imageId && IMAGE_MAP[data.imageId]) {
                    const img = document.createElement('img');
                    img.src = IMAGE_MAP[data.imageId];
                    const displayText = text.replace(/\(\d{3}\)/, '').trim();
                    el.appendChild(img);
                    const span = document.createElement('span');
                    span.textContent = displayText;
                    el.appendChild(span);
                } else {
                    el.textContent = text;
                }
                
                const nodeObj = {
                    el, 
                    x: 0, 
                    y: 0, 
                    isCore,
                    data, 
                    connected: false
                };

                // CLICK INTERACTION LOGIC
                const handleClick = (e) => {
                    e.stopPropagation(); // Prevent background click
                    
                    if (isCore) {
                        // Toggle Connection Mode
                        this.isConnecting = !this.isConnecting;
                        if (this.isConnecting) {
                            el.classList.add('active');
                            // Initialize pointer pos to center to avoid jump
                            this.pointerPos = { x: this.center.x, y: this.center.y };
                        } else {
                            el.classList.remove('active');
                        }
                    } else {
                        // Option Click
                        if (this.isConnecting) {
                            this.checkConnection(nodeObj);
                        }
                    }
                };

                el.addEventListener('click', handleClick);
                // Simple touch support mapping to click
                el.addEventListener('touchend', (e) => {
                    // prevent ghost clicks if needed, but standard click usually works fine
                });

                this.container.appendChild(el);
                this.updateDOMPos(nodeObj);
                return nodeObj;
            }

            checkConnection(targetNode) {
                if (!this.isConnecting) return;
                if (targetNode.connected) return; 

                if (targetNode.data.isTrue) {
                    this.handleSuccess(targetNode);
                } else {
                    this.handleFailure(targetNode);
                }
                
                // After attempt, reset connection mode
                this.cancelConnection();
            }

            handleSuccess(node) {
                node.connected = true;
                node.el.classList.add('connected');
                this.connections.push({ node: node });
                this.score += 10 + (this.streak * 2);
                this.streak++;
                this.completedTrueCount++;
                if (navigator.vibrate) navigator.vibrate(50);
                
                if (this.completedTrueCount >= this.totalTrueCount) {
                    setTimeout(() => this.levelComplete(), 800);
                }
                this.updateUI();
            }

            handleFailure(node) {
                node.el.classList.add('wrong');
                this.streak = 0;
                this.score = Math.max(0, this.score - 5);
                this.showOverlay("NOPE", "error");
                if (navigator.vibrate) navigator.vibrate([100, 50, 100]);
                setTimeout(() => { node.el.classList.remove('wrong'); }, 500);
                this.updateUI();
            }

            levelComplete() {
                this.showOverlay("COMPLETO", "success");
                setTimeout(() => {
                    this.startLevel();
                    this.msgOverlay.className = "overlay-msg";
                }, 1500);
            }

            showOverlay(text, type) {
                this.msgOverlay.textContent = text;
                this.msgOverlay.className = `overlay-msg show text-${type}`;
                setTimeout(() => {
                    if (type === 'error') this.msgOverlay.className = "overlay-msg";
                }, 1000);
            }

            updateUI() {
                this.scoreEl.innerText = this.score;
                this.streakEl.innerText = this.streak;
                this.updateProgressBar();
            }

            updateProgressBar() {
                const pct = (this.completedTrueCount / this.totalTrueCount) * 100;
                this.barEl.style.width = `${pct}%`;
            }

            updateDOMPos(node) {
                // Ensure absolute centering logic
                node.el.style.left = `${node.x}px`;
                node.el.style.top = `${node.y}px`;
                // Keep the translate to center the element on its coords
                node.el.style.transform = `translate(-50%, -50%)`;
            }

            loop() {
                const now = Date.now();
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                // Safety Re-center (in case of weird layout shifts)
                if (this.coreNode && (Math.abs(this.coreNode.x - this.center.x) > 1 || Math.abs(this.coreNode.y - this.center.y) > 1)) {
                    this.coreNode.x = this.center.x;
                    this.coreNode.y = this.center.y;
                    this.updateDOMPos(this.coreNode);
                }

                // Animate Floating Options
                this.currentNodes.forEach(node => {
                    if (!node.connected) {
                        const t = now * 0.001;
                        const floatX = Math.sin(t + node.floatOffset) * 10;
                        const floatY = Math.cos(t * 0.8 + node.floatOffset) * 10;
                        node.x = this.center.x + Math.cos(node.baseAngle) * node.radius + floatX;
                        node.y = this.center.y + Math.sin(node.baseAngle) * node.radius + floatY;
                        this.updateDOMPos(node);
                    } else {
                        // Implosion effect
                        const targetR = node.radius * 0.6; 
                        const dx = (this.center.x + Math.cos(node.baseAngle) * targetR) - node.x;
                        const dy = (this.center.y + Math.sin(node.baseAngle) * targetR) - node.y;
                        node.x += dx * 0.1;
                        node.y += dy * 0.1;
                        this.updateDOMPos(node);
                    }
                });

                // Draw Completed Connections
                this.ctx.lineWidth = 3;
                this.connections.forEach(conn => {
                    this.ctx.beginPath();
                    this.ctx.moveTo(this.center.x, this.center.y);
                    this.ctx.lineTo(conn.node.x, conn.node.y);
                    this.ctx.strokeStyle = '#4ade80'; 
                    this.ctx.stroke();
                    
                    const t = (now % 1000) / 1000;
                    const px = this.center.x + (conn.node.x - this.center.x) * t;
                    const py = this.center.y + (conn.node.y - this.center.y) * t;
                    this.ctx.beginPath();
                    this.ctx.arc(px, py, 4, 0, Math.PI*2);
                    this.ctx.fillStyle = '#fff';
                    this.ctx.fill();
                });

                // Draw Active Line (New Interaction)
                if (this.isConnecting) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(this.center.x, this.center.y);
                    this.ctx.lineTo(this.pointerPos.x, this.pointerPos.y);
                    this.ctx.strokeStyle = '#22d3ee'; // Cyan
                    this.ctx.lineCap = 'round';
                    this.ctx.lineWidth = 4;
                    this.ctx.shadowBlur = 15;
                    this.ctx.shadowColor = '#22d3ee';
                    this.ctx.stroke();
                    this.ctx.shadowBlur = 0;
                    
                    // Pointer circle
                    this.ctx.beginPath();
                    this.ctx.arc(this.pointerPos.x, this.pointerPos.y, 6, 0, Math.PI*2);
                    this.ctx.fillStyle = '#22d3ee';
                    this.ctx.fill();
                }

                requestAnimationFrame(() => this.loop());
            }
        }

        window.onload = () => {
            new Game();
        };

    </script>
</body>
</html>
